<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/util
        http://www.springframework.org/schema/util/spring-util-4.2.xsd">

    <!--é…ç½®æ•´åˆmybatisè¿‡ç¨‹-->
    <util:properties id="jdbc" location="classpath:jdbc.properties"/>

    <!--1.é…ç½®è¿žæŽ¥æ± å±žæ€?->
    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">
        <property name="driverClass" value="#{jdbc['mysql.driver']}"/>
        <property name="jdbcUrl" value="#{jdbc['jdbc.url']}"/>
        <property name="user" value="#{jdbc['jdbc.username']}"/>
        <property name="password" value="#{jdbc['jdbc.password']}"/>
        <property name="maxPoolSize" value="30"/>
        <property name="minPoolSize" value="10"/>
        <!--å…³é—­è¿žæŽ¥åŽä¸è‡ªåŠ¨commit-->
        <property name="autoCommitOnClose" value="false"/>
        <!--èŽ·å–è¿žæŽ¥è¶…æ—¶æ—¶é—´-->
        <property name="checkoutTimeout" value="10000"/>
        <!--èŽ·å–è¿žæŽ¥é‡è¯•æ¬¡æ•°-->
        <property name="acquireRetryAttempts" value="3"/>
    </bean>

    <!--2.é…ç½®SqlSessionFactoryå¯¹è±¡-->
    <bean id="sqlSessionFactory" class="org.mybatis.spring.SqlSessionFactoryBean">
        <!--æ³¨å…¥æ•°æ®åº“è¿žæŽ¥æ± -->
        <property name="dataSource" ref="dataSource"/>
        <!--é…ç½®mybatiså…¨å±€é…ç½®æ–‡ä»¶:mybatis-config.xml-->
        <property name="configLocation" value="classpath:mybatis-config.xml"/>
        <!--æ‰«æentityåŒ?ä½¿ç”¨åˆ«å,å¤šä¸ªç”?éš”å¼€-->
        <property name="typeAliasesPackage" value="org.seckill.entity"/>
        <!--æ‰«æsqlé…ç½®æ–‡ä»¶:mapperéœ?¦çš„xmlæ–‡ä»¶-->
        <property name="mapperLocations" value="classpath:mapper/*.xml"/>
    </bean>

    <!--3:é…ç½®æ‰«æDaoæŽ¥å£åŒ?åŠ¨æ?å®žçŽ°DAOæŽ¥å£,æ³¨å…¥åˆ°springå®¹å™¨-->
    <bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">
        <!--æ³¨å…¥SqlSessionFactory-->
        <property name="sqlSessionFactoryBeanName" value="sqlSessionFactory"/>
        <!-- ç»™å‡ºéœ?¦æ‰«æçš„DaoæŽ¥å£-->
        <property name="basePackage" value="org.seckill.dao"/>
    </bean>

    <!--RedisDao-->
    <bean id="redisDao" class="org.seckill.dao.cache.RedisDao">
        <constructor-arg index="0" value="localhost"/>
        <constructor-arg index="1" value="6379"/>
    </bean>

</beans>
